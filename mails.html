<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <title>Archetype Dev Tool</title>
        <style>
            body {
                font-family: monospace;
                margin: 0;
                display: flex;
                height: 100vh;
                background: #f4f4f4;
                color: #333;
            }

            /* SIDEBAR */
            aside {
                width: 350px;
                background: #fff;
                border-right: 1px solid #ccc;
                display: flex;
                flex-direction: column;
            }

            .toolbar {
                padding: 10px;
                border-bottom: 1px solid #ccc;
                background: #e0e0e0;
            }

            .toolbar button {
                width: 100%;
            }

            ul {
                list-style: none;
                padding: 0;
                margin: 0;
            }

            /* MAIN */
            main {
                flex: 1;
                padding: 20px;
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }

            .actions {
                margin-bottom: 10px;
                padding-bottom: 10px;
                border-bottom: 1px solid #ccc;
            }

            pre {
                background: #222;
                color: #0f0;
                padding: 15px;
                flex: 1;
                overflow: auto;
                margin: 0;
                border: 1px solid #000;
            }

            label {
                display: block;
                margin-bottom: 10px;
            }

            input,
            textarea,
            select {
                width: 100%;
                font-family: monospace;
            }

            textarea {
                resize: vertical;
            }

            button {
                cursor: pointer;
                padding: 4px 8px;
                border: 1px solid #999;
                background: #eee;
                font-family: monospace;
            }

            button:hover {
                background: #ddd;
            }
        </style>
    </head>

    <body>

        <aside>
            <div class="toolbar">
                <button onclick="sendEmail()">Send Email</button>
            </div>
        </aside>

        <main>
            <h2 style="margin-top:0">/api/email/send</h2>

            <div class="actions">
                <label>
                    Destinations (comma separated)
                    <input id="dest" type="text" value="test@example.com">
                </label>

                <label>
                    Subject
                    <input id="obj" type="text" value="Test email">
                </label>

                <label>
                    Type
                    <select id="type">
                        <option value="text">text</option>
                        <option value="html">html</option>
                    </select>
                </label>

                <label>
                    Content
                    <textarea id="content" rows="6">Hello from email API test</textarea>
                </label>
            </div>

            <strong>API Response:</strong>
            <pre id="output">Waiting...</pre>
        </main>

        <script>
            async function api(method, body) {
                let opts = { method, headers: { 'Content-Type': 'application/json' } };
                if (body) opts.body = JSON.stringify(body);
                let res = await fetch('/api/email/send', opts);
                return await res.json();
            }

            async function sendEmail() {
                let payload = {
                    dest: document.getElementById('dest').value,
                    obj: document.getElementById('obj').value,
                    type: document.getElementById('type').value,
                    content: document.getElementById('content').value
                };

                try {
                    let res = await api('POST', payload);
                    document.getElementById('output').textContent = JSON.stringify(res, null, 2);
                } catch (e) {
                    document.getElementById('output').textContent = e.toString();
                }
            }
        </script>

    </body>

</html>