# ------------------------------------------------------------------------------
# ARCHETYPE: SERVER CONFIGURATION
# ------------------------------------------------------------------------------

# SECURITY: Disable directory browsing and MultiViews logic
Options -Indexes -MultiViews

# ROUTING: Enable rewrite engine and set base path
# Change RewriteBase to /subfolder/ if not deployed at root
RewriteEngine On
RewriteBase /

# ROUTING: Redirect root URL "/" to the main dashboard
RewriteRule ^$ index.php [L]

# SECURITY: Deny direct access to core system directories
RewriteRule ^core(?:/|$) - [F,L]
RewriteRule ^data(?:/|$) - [F,L]
RewriteRule ^vendor(?:/|$) - [F,L]

# SECURITY: Deny access to sensitive configuration files
RewriteRule ^\.env$ - [F,L]
RewriteRule ^composer\.(json|lock)$ - [F,L]

# SECURITY: Deny access to hidden files/folders (allow .well-known for SSL)
RewriteRule ^\.(?!well-known/) - [F,L]

# ROUTING: Rewrite pretty URLs to PHP endpoints
# Example: /api/user-login -> /api/user-login.php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]